#
# python script to generate Life.asm HACK assembly code for boards
#

def hack(b):

	print ""
	print "(" + b[0] + ")"
	print ""

	for i in range(1,33):
		print "// [" + b[i] + "]"

	print ""

	base = 9800

	# for each row in the board

	for i in range(1,33):

		row = b[i]

		print "// [" + row + "] (Row " + str(i) + ")"
		print ""

		# pack 16 cells into each word

		for j in range(0,4):

			word = 0
			bits = row[0:16]
			row = row[16:]

			for k in range(0,16):
				word = word + word + (0 if bits[k] == " " else 1)

			# special processing based on value

			if word >= 32768:
				if word == 65535:
					print "\t@" + "{:05}".format(base) + "\t\t// [" + bits + "] " + str(word)
					print "\tM = -1"
				else:
					print "\tD = -1\t\t// [" + bits + "] " + str(word)
					print "\t@" + "{:05}".format(65535-word)
					print "\tD = D - A"
					print "\t@" + "{:05}".format(base)
					print "\tM = D"
			else:
				if word == 0:
					print "\t@" + "{:05}".format(base) + "\t\t// [" + bits + "] " + str(word)
					print "\tM = 0"
				else:
					print "\t@" + "{:05}".format(word) + "\t\t// [" + bits + "] " + str(word)
					print "\tD = A"
					print "\t@" + "{:05}".format(base)
					print "\tM = D"

			base += 1

		print ""

	print "// return to caller"
	print ""
	print "\t@SP\t\t// Jump to [++SP]"
	print "\tAM = M + 1"
	print "\tA = M"
	print "\t0 ; JMP"
	print ""

def wrap(f,t):

	print"\t@" + str(f)
	print"\tD = M"
	print"\tM = 0"
	print"\t@" + str(t)
	print"\tM = M + D"
	print""

def table(l,v):

	print"\t@" + str(v)
	print"\tD = A"
	print"\t@" + str(l)
	print"\tM = D"
	print""

def div2table(l1,l2,v):

	print"\t@" + str(v)
	print"\tD = A"
	print"\t@" + str(l1)
	print"\tM = D"
	print"\t@" + str(l2)
	print"\tM = D"
	print""

# main code

hack([

"Logo.Board",

"****************************************************************" ,
"*                                                              *" ,
"*  ****    *****   **  **  **   **   *****  **   **  *  *****  *" ,
"* **  **  **   **  *** **  **   **  **   ** **   ** *  **      *" ,
"* **      **   **  ******  ** * **  *******  ******     *****  *" ,
"* **  **  **   **  ** ***  *******  **   **      **         ** *" ,
"*  ****    *****   **  **   ** **   **   **  *****      *****  *" ,
"*                                                              *" ,
"*  ****    *****   *** ***  ******             *****   ******* *" ,
"* **  **  **   **  *******  **                **   **  **      *" ,
"* **      *******  ** * **  ******            **   **  *****   *" ,
"* **  **  **   **  **   **  **                **   **  **      *" ,
"*  *****  **   **  **   **  ******             *****   **      *" ,
"*                                                              *" ,
"*   ****            ********    ************    ************   *" ,
"*   ****            ********    ************    ************   *" ,
"*   ****            ********    ************    ************   *" ,
"*   ****              ****      ****            ****           *" ,
"*   ****              ****      ********        ********       *" ,
"*   ****              ****      ********        ********       *" ,
"*   ****              ****      ****            ****           *" ,
"*   ************    ********    ****            ************   *" ,
"*   ************    ********    ****            ************   *" ,
"*   ************    ********    ****            ************   *" ,
"*                                                              *" ,
"*  ****                   *                    *             * *" ,
"* *    *                  *                    *             * *" ,
"* * ** *     * *   ***  ***  **  *   *  **  ** *  **   **  *** *" ,
"* * ****    * * * *  * *  * *  *  * *  **  *   * *  * *   *  * *" ,
"*  *        *   *  ***  ***  **    *    ** *   *  **  *    *** *" ,
"*                                                              *" ,
"****************************************************************"

]
)

hack([

"Oscillator.Board",

"     **                                                         " ,
"***  *      ***     ***   ***                                   " ,
"        *  ***                                   *              " ,
"       **         *    * *    *                * *              " ,
"                  *    * *    *               * *               " ,
"  **              *    * *    *         **   *  *           **  " ,
"                    ***   ***           **    * *           **  " ,
"*   *                                          * *              " ,
"*    *              ***   ***                    *              " ,
"  * * *           *    * *    *                                 " ,
"   * * *          *    * *    *                                 " ,
"    *    *        *    * *    *                                 " ,
"     *   *                                                      " ,
"                    ***   ***                                   " ,
"      **                                                        " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                 **                             " ,
"                **               * *       **                   " ,
"                **                 *       **                   " ,
"                                 ***                            " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                 ***                            " ,
"                **                 *                            " ,
"                **               * *                            " ,
"                                 **                             " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,

]
)

hack([

"Gliders.Board",

"                                                                " ,
"     *                                                          " ,
"   *   *                                                *       " ,
"        *                                                *      " ,
"   *    *                                              ***      " ,
"    *****                                                       " ,
"                    *                                           " ,
"                     *                                          " ,
"                   ***      **                                  " ,
"                          *    *                                " ,
"                                *                               " ,
"                          *     *                               " ,
"                           ******                               " ,
"                                                                " ,
"                                                    ****        " ,
"                                                   ******       " ,
"                                          *        **** **      " ,
"                                           *           **       " ,
"                                         ***                    " ,
"                                               **               " ,
"      *                                      *            *     " ,
"       *                                                   *    " ,
"     ***                                     *             *    " ,
"                                              **************    " ,
"                                  *                             " ,
"                                   *                            " ,
"                                 ***                ****        " ,
"                                                   ******       " ,
"                                                   **** **      " ,
"                                                       **       " ,
"                                                                " ,
"                                                                " ,

]
)

hack([

"Gosper.Glider.Gun",

"                                                                " ,
"                         *                                      " ,
"                       * *                                      " ,
"             **      **            **                           " ,
"            *   *    **            **                           " ,
" **        *     *   **                                         " ,
" **        *   * **    * *                                      " ,
"           *     *       *                                      " ,
"            *   *                                               " ,
"             **                                                 " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                         **                     " ,
"                                         * *                    " ,
"                                           *                    " ,
"                                           **                   " ,
"                                                                " ,

]
)

hack([

"Beacon.Maker",

"                               *                                " ,
"                              *                               **" ,
"                             *                               * *" ,
"                            *                               *   " ,
"                           *                               *    " ,
"                          *                               *     " ,
"                         *                               *      " ,
"                        *                               *       " ,
"                       *                               *        " ,
"                      *                               *         " ,
"                     *                               *          " ,
"                    *                               *           " ,
"                   *                               *            " ,
"                  *                               *             " ,
"                 *                               *              " ,
"                *                               *               " ,
"               *                               *                " ,
"              *                               *                 " ,
"             *                               *                  " ,
"            *                               *                   " ,
"           *                               *                    " ,
"          *                               *                     " ,
"         *                               *                      " ,
"        *                               *                       " ,
"       *                               *                        " ,
"      *                               *                         " ,
"     *                               *                          " ,
"    *                               *                           " ,
" ***                               *                            " ,
"   *                              *                             " ,
"   *                             *                              " ,
"                                *                               " ,

]
)

hack([

"Blinker.Puffer",

"                                                                " ,
"                                                                " ,
"        *                                                       " ,
"      *   *                                                     " ,
"     *                                                          " ,
"     *    *                                             **      " ,
"     *****                                             ** ****  " ,
"                                                        ******  " ,
"                                                         ****   " ,
"                                                                " ,
"      **                                                        " ,
"     ** ***                                                     " ,
"      ****   *** *** *** *** *** *** *** *** *** *** *** ***    " ,
"       **                                                       " ,
"                                                                " ,
"          **                                                    " ,
"        *    *                                                  " ,
"       *                                                        " ,
"       *     *                                                  " ,
"       ******                                                   " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,
"                                                                " ,

]
)

# generates some utility tables (disabled)

if (False):
	print "Divide by 2 table"

	for i in range(0,32):
		div2table(9700+i*2,9701+i*2,i)

	print "Guard cell fixing code"

	wrap(10000,12176)
	wrap(10065,12113)
	wrap(12178,10130)
	wrap(12243,10067)

	print ""

	for i in range(1,65):
		wrap(10000+i,12112+i)
		wrap(12178+i,10066+i)

	print ""

	for i in range(1,32):
		wrap(10000+66*i,10064+66*i)
		wrap(10065+66*i,10001+66*i)

